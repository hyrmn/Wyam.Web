<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <meta name="description" content="Wyam is a simple to use, highly modular, and extremely configurable static content generator." />
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <title>Wyam - Configuration</title>
        <link href="/Content/bootstrap-less/bootstrap.css" rel="stylesheet" />
        <link href="/Content/adminlte/AdminLTE.css" rel="stylesheet" />
        <link href="/Content/adminlte/skins/wyam.css" rel="stylesheet" />
        <link href="/Content/prettify.css" rel="stylesheet">
        <link href="/Content/github.css" rel="stylesheet">
        <link href="/Content/master.css" rel="stylesheet" />
        <link href='https://fonts.googleapis.com/css?family=Roboto:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <script src="/Scripts/jQuery-2.1.4.min.js"></script>
        <script src="/Scripts/bootstrap.min.js"></script>        
        <script src="/Scripts/app.min.js"></script>         
        <script src="/Scripts/prettify.js"></script>   
        <script src="/Scripts/jquery.slimscroll.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/Scripts/html5shiv.min.js"></script>
        <script src="/Scripts/respond.min.js"></script>
        <![endif]-->  
    </head>

    <body class="hold-transition wyam layout-boxed  " onload="prettyPrint()">    
        <div class="top-banner"></div>
        <div class="wrapper">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/" class="logo">
                    <!-- mini logo for sidebar mini 50x50 pixels -->
                    <span class="logo-mini"><img src="/Content/images/nav-logo.png"></span>
                    <!-- logo for regular state and mobile devices -->
                    <span class="logo-lg"><img src="/Content/images/nav-logo.png"></span>
                </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li class="active"><a href="/getting-started">Getting Started</a></li>
                                    <li><a href="/modules">Modules</a></li>
                                    <li><a href="/api">API</a></li>
                                    <li><a href="/knowledgebase">Knowledgebase</a></li>
                                    <li><a href="/community">Community</a></li>

                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                    
                </nav>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="sidebar smaller">                    
                    
                    <!-- search form -->
                    
                    
                    <!-- sidebar menu: : style can be found in sidebar.less -->
                    <ul class="sidebar-menu">
                        
	
				<li>
				<a href="/getting-started/obtaining">
					Obtaining
				</a>
			</li>
			<li>
				<a href="/getting-started/usage">
					Usage
				</a>
			</li>
			<li>
				<a href="/getting-started/concepts">
					Concepts
				</a>
			</li>
			<li class="active">
				<a href="/getting-started/configuration">
					Configuration
				</a>
			</li>
			<li>
				<a href="/getting-started/defaults">
					Defaults
				</a>
			</li>
			<li>
				<a href="/getting-started/examples">
					Examples
				</a>
			</li>



                    </ul>
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                


	<section class="content-header">
		<h1>Configuration</h1>
	</section>
	<section class="content">
		


<p>The command line Wyam application reads a configuration file typically named <code>config.wyam</code> (though you can change that with an argument) that sets up the environment and initializes metadata and pipelines. It consists of three parts, the <em>setup</em>, any <em>declarations</em>, and the <em>body</em>, in that order. The setup is separated by a line consisting entirely of one or more equals (<code>===</code>) and the declarations are separated by a line consisting entirely of one or more dashes (<code>---</code>).</p>
<p>The sections of the configuration file are evaluated as C# code, so you can make use of the full C# language and the entire .NET ecosystem. However, it's not necessary to know C# to write Wyam configuration files. The syntax has been carefully crafted to be usable by anyone no matter their level of programming experience.</p>
<p>A configuration file looks like this:</p>
<pre class="prettyprint"><code>// Setup code (optional)
// ...

===

// Declaration code (optional)
// ...

---

// Body code (required)
// ...
</code></pre>
<h1>Setup</h1>
<hr />
<p>The setup helps establish the Wyam environment and gets evaluated before the rest of the configuration file. It's generally responsible for declaring NuGet packages, assemblies, and namespaces that should be made available to the main configuration body. Any modules that exist in referenced NuGet packages or assemblies will get automatically imported for use in pipelines. Additionally, the objects in NuGet packages and assemblies will be available from the configuration body and any specified namespaces will be brought into scope. Note that while the setup portion of the configuration file is evaluated as C# code just like the configuration body, it only references a small subset of the .NET class library (basically just enough to set things up).</p>
<h2><a name="nuget"></a>NuGet</h2>
<p>Wyam can automatically install any NuGet packages you declare in the setup portion of the configuration file. These will then be scanned for modules and be made available to the main configuration body. NuGet packages are configured using the global <code>Packages</code> object and a fluent interface.</p>
<p><code>Packages.Install(string packageId, string versionSpec = null, bool allowPrereleaseVersions = false, bool allowUnlisted = false)</code> will let you specify a NuGet package to download from the default package source, which is the main NuGet.org feed. <code>Packages.Repository(string packageSource)</code> will let you define alternate package sources (such as an internal NuGet feed or a feed on MyGet). You can then continue to chain additional <code>Install()</code> calls as before. For example:</p>
<pre class="prettyprint"><code>Packages
    .Install(&quot;Humanizer&quot;)
    .Install(&quot;Newtonsoft.Json&quot;);
Packages.Repository(&quot;https://www.myget.org/F/roslyn-nightly/&quot;)
    .Install(&quot;Microsoft.CodeAnalysis&quot;)
    .Install(&quot;Microsoft.CodeAnalysis.Scripting&quot;);
</code></pre>
<p>From the <code>Install()</code> method you can also specify the acceptable package version(s) and whether prerelease and/or unlisted packages should be allowed. The <code>versionSpec</code> argument takes a string that matches the standard NuGet version specifications defined at https://docs.nuget.org/create/versioning</p>
<p>By default, packages are downloaded to <code>\packages</code>. If you want to change this, set <code>Packages.Path</code> to the relative folder where you want packages to be downloaded. For example, you could set this to a system-wide folder if you have several scripts that share the same packages.</p>
<h2><a name="assemblies"></a>Assemblies</h2>
<p>In addition to NuGet packages you can also load assemblies. This is accomplished by using the <code>Assemblies</code> property. You can load all the assemblies in a directory with the <code>LoadDirectory(string path, SearchOption searchOption = SearchOption.AllDirectories)</code> method. The specified directory can either be relative to the active directory or absolute. You can also load a single assembly by location with the <code>LoadFile(string path)</code> method and by full name with the <code>Load(string name)</code> method. For example:</p>
<pre class="prettyprint"><code>Assemblies
    .LoadDirectory(&#64;&quot;lib&quot;)
	.LoadFile(&#64;&quot;foo\bar.dll&quot;)
	.Load(&quot;SampleAssembly, Version=1.0.2004.0, Culture=neutral, PublicKeyToken=8744b20f8da049e3&quot;);
</code></pre>
<p>Keep in mind that system assemblies and others located in the GAC <em>must</em> be loaded by full name (including the version, public key token, etc.).</p>
<p>By default, the following assemblies are already loaded so you don't need to explicity specify them:</p>
<ul>
<li><code>System</code></li>
<li><code>System.Collections.Generic</code></li>
<li><code>System.Linq</code></li>
<li><code>System.Core</code></li>
<li><code>Microsoft.CSharp</code></li>
<li><code>System.IO</code></li>
<li><code>System.Diagnostics</code></li>
</ul>
<p>Also note that all assemblies from the directory containing the Wyam executable (and all subdirectories) will also be scanned for module assemblies.</p>
<h2>Folders</h2>
<p>You can configure the folders Wyam uses by setting <code>RootFolder</code>, <code>InputFolder</code>, and/or <code>OutputFolder</code> in the setup script.</p>
<h1><a name="declarations"></a>Declarations</h1>
<hr />
<p>The code in your configuration is typically executed inside the context of an &quot;invisible&quot; class and method. This means that you can't bring namespaces into scope, create classes, declare helper methods, etc. If you need to do any of these things, place it above the configuration code and separate it with a line consisting entirely of one or more dashes (<code>---</code>). Any code above this line will be evaluated outside the scope of the configuration method or any class. This means that you can bring namespaces into scope with <code>using</code> statements, declare helper classes, etc. Note that this code is global, so if you want to declare helper methods, they'll have to be placed within a wrapper class.</p>
<pre class="prettyprint"><code>// Declaration code

using System.IO;

public static class Helpers
{
	public string GetWriteExtension()
	{
		return &quot;.html&quot;;
	}
}

---

// Configuration code

Pipelines.Add(&quot;Markdown&quot;,
	ReadFiles(&quot;*.md&quot;),
    FrontMatter(Yaml()),
	Markdown(),
	WriteFiles(Helpers.GetWriteExtension())
);
</code></pre>
<p>Note that namespaces for all found modules as well as the following namespaces are automatically brought into scope for every configuration script so you won't need to explicitly add them:</p>
<ul>
<li><code>System</code></li>
<li><code>System.Collections.Generic</code></li>
<li><code>System.Linq</code></li>
<li><code>System.IO</code></li>
<li><code>System.Diagnostics</code></li>
</ul>
<h1><a name="body"></a>Body</h1>
<hr />
<h2>Initial Metadata</h2>
<p>Each pipeline starts with a single document prepopulated with initial metadata you specify in the configuration file. You can use this facility to introduce variables that can influence the way the pipeline behaves. To set initial metadata, just add values to the <code>InitialMetadata</code> property (it's of type <code>IInitialMetadata</code> which implements <code>IDictionary&lt;string, object&gt;</code>). Note that the dictionary values are objects, so you can store simple primitive values or complex structure. For example:</p>
<pre class="prettyprint"><code>InitialMetadata[&quot;Foo&quot;] = &quot;Bar&quot;;
InitialMetadata.Add(&quot;Baz&quot;, new KeyValuePair&lt;string, string&gt;(&quot;abc&quot;, &quot;xyz&quot;)); 
</code></pre>
<h2>Pipelines</h2>
<p>Configuring a pipeline is easy, and Wyam configuration files are designed to be simple and straightforward:</p>
<pre class="prettyprint"><code>Pipelines.Add(
	ReadFiles(&quot;*.md&quot;),
	Markdown(),
	WriteFiles(&quot;.html&quot;)
);
</code></pre>
<p>However, don't let the simplicity fool you. Wyam configuration files are C# scripts and as such can make use of the full C# language and the entire .NET ecosystem (including the built-in support for NuGet and other assemblies as explained above). One of the core modules even lets you write a delegate right in your configuration file for extreme flexibility.</p>
<h3>Pipeline Names</h3>
<p>Pipelines should be given names, which makes them easier to identify in trace messages and also makes them easier to refer to within templates (for example, to get all the documents generated by a previous pipeline). Just pass in the name of a pipeline as the first parameter to the <code>Add()</code> method. If no name is provided (as above), then pipelines will implicitly be given the names <code>Pipeline 1</code>, <code>Pipeline 2</code>, etc.</p>
<pre class="prettyprint"><code>Pipelines.Add(&quot;Markdown&quot;,
	ReadFiles(&quot;*.md&quot;),
    FrontMatter(Yaml()),
	Markdown(),
	WriteFiles(&quot;.html&quot;)
);
</code></pre>
<h3>Child Modules</h3>
<p>Some modules also accept child modules as part of their processing. For example, the <code>FrontMatter</code> module accepts a child module to handle parsing whatever front matter content is found. This way, the same module can be used to recognize front matter without it having to worry about what kind of content the front matter contains (such as YAML or JSON). For example:</p>
<pre class="prettyprint"><code>Pipelines.Add(&quot;Markdown&quot;,
	ReadFiles(&quot;*.md&quot;),
    FrontMatter(Yaml()),
	Markdown(),
	WriteFiles(&quot;.html&quot;)
);
</code></pre>
<h3>Skipping Previously Processed Documents</h3>
<p>If you know that a given pipeline doesn't use data from other pipelines and you'd like to prevent reprocessing of documents after the first pass, you can set the <code>processDocumentsOnce</code> flag. Under the hood, this looks for the first occurrence of a given <code>IDocument.Source</code> and then caches all final result documents that have the same source. On subsequent executions, if a document with a previously seen <code>IDocument.Source</code> is found <em>and it has the same content</em>, that document is removed from the module output and therefore won't get passed to the next module. At the end of the pipeline, all the documents from the first pass that have the same source as the removed one are added back to the result set (so later pipelines can still access them in the documents collection if needed). The <code>processDocumentsOnce</code> flag can be set when creating a pipeline:</p>
<pre class="prettyprint"><code>Pipelines.Add(&quot;Markdown&quot;, true,
	ReadFiles(&quot;*.md&quot;),
    FrontMatter(Yaml()),
	Markdown(),
	WriteFiles(&quot;.html&quot;)
);
</code></pre>
<h3>Explicit Module Instantiation</h3>
<p>Note that you supply the pipeline with new instances of each module. An astute reader will notice that in the example above, modules are being specified with what look like global methods. These methods are just shorthand for the actual module class constructors and this convention can be used for any module within the configuration script. The example configuration above could also have been written as:</p>
<pre class="prettyprint"><code>Pipelines.Add(&quot;Markdown&quot;,
	new ReadFiles(&quot;*.md&quot;),
	new Markdown(),
	new WriteFiles(&quot;.html&quot;)
);
</code></pre>
<h3>Automatic Lambda Generation</h3>
<p>Many modules accept functions so that you can use information about the current <code>IExecutionContext</code> and/or <code>IDocument</code> when executing the module. For example, you may want to write files to disk in different locations depending on some value in each document's metadata. To make this easier in simple cases, and to assist users who may not be familiar with the <a href="https://msdn.microsoft.com/en-us/library/bb397687.aspx">C# lambda expression syntax</a>, the configuration file will automatically generate lambda expressions when using a special syntax. This generation will only happen for module constructors and fluent configuration methods. Any other method you use that requires a function will still have to specify it explicitly.</p>
<p>If the module or fluent configuration method has a <code>ContextConfig</code> delegate argument, you can instead use any variable name that starts with <code>&#64;ctx</code>. For example:</p>
<pre class="prettyprint"><code>Foo(&#64;ctx2.InputFolder)
</code></pre>
<p>will be expanded to:</p>
<pre class="prettyprint"><code>Foo(&#64;ctx2 =&gt; &#64;ctx2.InputFolder)
</code></pre>
<p>Likewise, any variable name that starts with <code>&#64;doc</code> will be expanded to a <code>DocumentConfig</code> delegate. For example:</p>
<pre class="prettyprint"><code>Foo(&#64;doc[&quot;SomeMetadataValue&quot;])
</code></pre>
<p>will be expanded to:</p>
<pre class="prettyprint"><code>Foo((&#64;doc, _) =&gt; &#64;doc[&quot;SomeMetadataValue&quot;])
</code></pre>
<p>If you use both <code>&#64;ctx</code> and <code>&#64;doc</code>, a <code>DocumentConfig</code> delegate will be generated that uses both values. For example:</p>
<pre class="prettyprint"><code>Foo(&#64;doc[&#64;ctx.InputFolder])
</code></pre>
<p>will be expanded to:</p>
<pre class="prettyprint"><code>Foo((&#64;doc, &#64;ctx) =&gt; &#64;doc[&#64;ctx.InputFolder])
</code></pre>
<h2>Folders</h2>
<p>You can access the folders Wyam uses by getting <code>RootFolder</code>, <code>InputFolder</code>, and/or <code>OutputFolder</code> in the configuration script.</p>
<h2>Execution Ordering</h2>
<p>Be aware that the configuration file only <em>configures</em> the pipelines. Each pipeline is executed in the order in which they were first added after the entire configuration file is evaluated. This means that you can't declare one pipeline, then declare another, and then add a new module to the first pipeline expecting it to reflect what happened in the second one. The second pipeline won't execute until the entire first pipeline is complete, including any modules that were added to it after the second one was declared. If you need to run some modules, switch to a different pipeline, and the perform additional processing on the first set of documents, look into the <a href="/modules/documents">Documents</a> module.</p>
<h1>Example</h1>
<hr />
<p>The full configuration file for this documentation site is given below as an example:</p>
<pre class="prettyprint"><code>// Setup code
Packages
	.Install(&quot;Twitter.Bootstrap.Less&quot;, &quot;[3.3.5]&quot;)
	.Install(&quot;jQuery&quot;, &quot;[2.1.1]&quot;);
	
===
// Body code

Pipelines.Add(&quot;Content&quot;,
	ReadFiles(&quot;*.md&quot;),
	FrontMatter(Yaml()),
	Markdown(),
	Replace(&quot;&lt;pre&gt;&lt;code&gt;&quot;, &quot;&lt;pre class=\&quot;prettyprint\&quot;&gt;&lt;code&gt;&quot;),
	Concat(
		ReadFiles(&quot;*.cshtml&quot;).Where(x =&gt; Path.GetFileName(x)[0] != '_'),
		FrontMatter(Yaml())		
	),
	Razor(),
	AutoLink(c =&gt; c.Documents
		.FromPipeline(&quot;Content&quot;)
		.Where(x =&gt; x.String(&quot;RelativeFileDir&quot;) == &quot;api&quot; &amp;&amp; !string.IsNullOrWhiteSpace(x.String(&quot;Title&quot;)))
		.ToDictionary(x =&gt; x.String(&quot;Title&quot;), x =&gt; PathHelper.ToRootLink(Path.ChangeExtension(x.String(&quot;RelativeFilePath&quot;), &quot;.html&quot;)))),
	WriteFiles(&quot;.html&quot;)
);

Pipelines.Add(&quot;Less&quot;,
    ReadFiles(&quot;master.less&quot;),
    Concat(ReadFiles(&quot;bootstrap.less&quot;)),
    Less(),
    WriteFiles(&quot;.css&quot;)
);

Pipelines.Add(&quot;Resources&quot;,
	CopyFiles(&quot;*&quot;).Where(x =&gt; 
		Path.GetExtension(x) != &quot;.cshtml&quot; 
		&amp;&amp; Path.GetExtension(x) != &quot;.md&quot;
		&amp;&amp; Path.GetExtension(x) != &quot;.less&quot;)
);
</code></pre>


	</section>
                
            </div>
            
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer"><small>Wyam is crafted by <a href="http://www.daveaglick.com">Dave Glick</a> and <a href="https://github.com/Wyamio/Wyam/graphs/contributors">other awesome contributors</a>. <a href="https://github.com/Wyamio/Wyam">Code on GitHub</a>. This site was entirely generated by Wyam. Check out <a href="https://github.com/Wyamio/Wyam.Web">the site code on GitHub</a>.</small></footer>
        </div>
        <div class="github-button">
            <a href="https://github.com/Wyamio/Wyam"><i class="fa fa-github"></i> GitHub</a>
        </div>
        <script>
            ((window.gitter = {}).chat = {}).options = {
                room: 'wyamio/wyam'
            };
        </script>
        <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
        <script>            
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');            
            ga('create', 'UA-54470483-4', 'auto');
            ga('send', 'pageview');
        </script>
    </body>
</html>